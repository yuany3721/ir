计算机应用
云存储内容分发网络中的能耗优化方法
邓志刚，曾国荪，谭云兰，熊焕亮，
摘要：针对云存储内容分发网络(CCDN)中的高能耗问题，研究CCDN的能耗优化管理方法。首先，分析CCDN运行原理，给出每台云服务器和每条网络链路的能耗计算公式，利用加权图刻画整个网络系统；然后，基于加权图，给出满足CCDN系统服务质量(QoS)和网络系统数据分发的能耗优化图(MEG)算法。通过模拟实验将该算法与贪心站点(GS)算法和优化静态放置和路由(OSPR)算法进行比较，结果显示:在系统可扩展实验中，MEG能耗比GS和OSPR能耗分别少6.6%和30%；在保证用户QoS的实验中，MEG能耗比GS和OSPR能耗分别少28.9%和60.2%；在网络拓扑密度实验中，MEG的能耗比GS和OSPR能耗分别少32.2%和89.3%。实验结果表明，所提算法能够大幅度降低CCDN的能耗开销。
关键词：云存储内容分发网络；网络系统服务质量；加权图；图算法；能耗优化
零、引言
0引言
随着互联网用户数量的迅速增加，提高大规模数字内容的网络分发效率已成为近年来国内外研究的热点问题。当前，针对提高大规模数字内容的网络分发效率，采取的主流技术是内容分发网络(ContentDistributionNetwork，CDN)。在CDN中，大量服务器被部署在互联网靠近用户的“边缘”，这些“边缘”服务器用于有策略地存储源服务器中的内容，从而减少“边缘”附近用户的访问时延。传统的大型CDN运营商，在全球建造了数百个数据中心，含数万台服务器，用于提供互联网规模的内容分发服务。过去十几年，互联网规模的内容分发网络提供的内容分发服务范围广阔，例如电子商务、娱乐、新闻等，已经为全球众多互联网用户所普遍使用。传统部署大规模的数据中心提供内容分发服务，对于中小型内容供应商，在经济上是不可行的。新出现的存储云运营商，例如AmazonS3，使得实现低成本的基于云的内容分发网络成为可能，从而成为了中小型内容供应商部署内容分发网络的曙光。存储云运营商能按需地提供内容存储和分发能力，同时，保证用户响应时间等服务质量。部署基于云存储的内容分发网络(CloudstorageContentDistributionNetwork，CCDN)，是一个互联网上的大规模分布式存储系统。一个拥有100000台服务器组成的大规模分布式系统平台每年大约需要消耗190000MWh的能耗，可以支持超过10000个家庭的能耗供应。高能耗带来了高的用户成本和高的CO2排放量导致的环境污染问题。因此，CCDN的能耗优化管理就成为了亟待解决的问题。目，国内外学者针对CDN的能耗优化问题已取得了一些研究成果。例如，2010年，意大利都灵理工大学的Chiaraviglio等提出一种通过动态提供CDN服务器和网络元素的方案，能够优化内容供应商和互联网服务提供商的能耗。2010年，摩托罗拉应用研究中心的Xu等针对部署了多个服务器集群的视频CDN环境，提出通过改善服务器本地命中率和减少开机服务器数目的方法，优化视频CDN的能耗。2012年，麻省大学的Mathew等针对CDN中的多个服务器集群环境，提出了一种综合考虑节能、可用性和性能均衡的内容分发方案，根据该方案打开和关闭集群内服务器和集群间服务器，以优化CDN能耗。2013年，贝尔实验室的Llorca等提出了考虑用户动态创建和动态请求内容对象的CDN能耗分析模型，通过离线分析系统用户请求和网络资源信息，给出在线内容对象缓存放置方案，能够优化整个CDN系统能耗。最近，在文献中出现了研究互联网规模的CCDN的研究报告。例如，2012年，宾夕法尼亚州立大学Chen等针对CCDN环境，给出了满足用户服务质(QualityofService，QoS)需求和最小化CCDN运营商存储和带宽成本的方案。2014年，瑞典林雪平大学的Carlsson等针对弹性云存储CCDN环境，建立CCDN用户服务请求概率模型，给出满足CCDN用户请求通信和存储代价优化方法，并且，对优化方法的合理性进行了数学证明2014年，同济大学曾国荪等提出利用价格时间自动机建模云计算系统动态行为，通过自动机算法给出云系统能耗优化方法，能够极大地降低云计算系统能耗。虽然研究者在传统CDN能耗优化方面做了较多工作，但不能直接应用于CCDN能耗优化管理。文献给出了最小化CCDN运营商成本的方案，但没有具体考虑对CCDN中云服务器和云网络通信能耗优化。文献研究了CCDN通信和存储代价优化方法，但没有考虑CCDN关键因素用户QoS。文献分析了CCDN云中心服务器能耗优化方案，但没有考虑云网络通信能耗。本文针对CCDN系统高能耗问题，综合考虑CCDN中通信能耗、存储能耗和系统用户QoS，通过给出CCDN通信能耗和存储服务器能耗计算公式，利用加权无向图建模CCDN系统存储能耗特征、通信能耗特征和系统用户QoS特征，分析加权图中存储节点通信能耗约束的节点覆盖集和存储节点能耗因素，给出节点覆盖集和存储能耗加权值的节点优化分发启发式函数，利用节点优化分发启发式函数，提出了CCDN优化能耗图(Min-Energy-Graph，MEG)算法。1云内容分发网络运行原理1.1CCDN的组成框架一个CCDN由用户、源服务器和云站点组成。图1表示了由5个用户、1个源服务器和5个云站点组成的CCDN框架。更多个用户、更多个源服务器和云站点的复杂CCDN组成框架与图1类似，没有本质的不同，只是用户数、源服务器数、云站点数和网络连接不同而已。图1CCDN组成框架CCDN用户通过互联网请求获取CCDN数据。CCDN数据是CCDN内容运营商提供的内容对象。本文假定一个CCDN内容供应商提供一个内容对象，例如，一个电影网站。为了区分不同物理地点的CCDN用户，本文假定一个物理地点接近的由同一个互联网服务提供商(InternetServiceProvider，ISP)服务的CCDN用户，划分在一个CCDN用户组之中，分布在不同物理地点的CCDN所有用户，划分在多个CCDN用户组之中。本文对用户组和用户不加区分。CCDN用户集合表示为U={U1，U2，…，Un}。CCDN源服务器是存储CCDN运营商数据的云存储服务器。云运营商，将CCDN运营商的CCDN数据，迁移到专用的云存储服务器中。现今，一台云存储服务器的存储容量已可满足一个CCDN小型运营商的存储要求。例如，一台IBMSYSTEMX3650M4最大存储容量达到9TB，可存储220万张4MB大小的高清照片，也可存储9216部1GB大小的高清电影。对于大中型CCDN内容供应商，对存储容量需求很大，可通过多个源服务器组成的存储服务器集群系统满足要求。为了使问题简化，又不失一般性，本文仅考虑CCDN小型内容供应商需要一台源服务器的情况。源服务器表示为S0。CCDN云站点存储源服务器数据的副本，是在云中租用的云存储服务器。云站点的数据副本，可以直接从源服务器发送来，也可以从另一个云站点转发来。租用云站点的主要目的是近距离地使用户快速获取源服务器中的数据副本。每个用户Ui，有一个地理位置最近的云站点Si，称为用户Ui的本地站点，其他的云站点，称为Ui的远程站点。CCDN云站点集合表示为S={S1，S2，…，Sn}。1.2CCDN数据分发的要求和假设CCDN中，每个用户优先发送数据请求到本地云站点:如果本地云站点有请求的数据副本，本地云站点传输数据给用户；否则，用户请求将定向到离本地云站点最近的存储有副本的云站点。每个云站点可服务多个用户的请求。为了简化CCDN能耗建模，本文假定所有服务请求由云站点发起。另外，由于从用户到云站点的通信不影响数据副本放置的决策，本文忽略从用户到服务器的通信。CCDN源服务器中的数据，可通过云网络，直接传输给云站点。一个云站点需要一个数据副本，除了可以通过源服务器传输也可从另一个有数据副本的云站点，传输到该云站点。对于每个云站点Si，对应有两个服务质量需求qd(Si)和qe(Si)。服务质量需求强制所有由Si产生的数据访问请求，必须在通信距离小于qd(Si)，传输副本的通信能耗小于qe(Si)的云站点提供服务。假定每个云站点感知到最近的存有副本实验环境的设置为了验证本文提出的MEG算法的有效性，本文将MEG算法与两个现代CCDN算法———贪心站点(GreedySite，GS)算法和优化静态放置和算法进行模拟实验比较。实验采用的硬件环境是DELLOptiplex320计算机，软件环境是WindowsXP操作系统。在本文的模拟实验中，输入网络拓扑由Waxman模型产生。在Waxman模型，N个节点被随机地放置于s×s的平面。一个边插入于两个节点Su和Sv之间，概率为p(u，v)=β·e－d(u，v)/αL，中:d(u，v)表示Su和Sv间的Euclidean距离，L是两个节点之间可能的最大距离。因此，L=槡2s，α和β是Waxman参数，并且α，β∈(0，1)。在本文实验中，节点数目N默认设定为100，s默认设定为200。参数α、β默认分别设定为0.2和0.7.实验使用GT-ITM1518计算机应用第36卷建模工具产生100个图，图边数的平均值是326。最后，设定存储能耗的默认值是100kJ，QoS需求的默认值，对于每个节点vi∈V，qd(i)和qe(i)都设为100。4.2系统扩展实验CCDN系统扩展，是需要考虑的重要因素。输入节点数目的变化，会使得系统能耗发生变化。本文给出系统扩展实验，实验参数设置中，除了节点数目以外，使用默认的参数值。实验由Waxman模型产生网络拓扑，重复实验20次，系统总能耗取平均值。实验结果如图2所示。图2不同云站点数的系统总能耗比较从图2观察到，MEG的系统总能耗比GS和OSPR都要少。MEG的平均系统总能耗，比GS少6.6%，比OSPR少30%。分析原因是:MEG算法集中考虑优化CCDN系统能耗，GS优先考虑节点尽可能多地满足用户请求数目，然后再考虑优化CCDN能耗；OSPR优先考虑完成每个用户请求时间的优化，然后再考虑优化CCDN能耗。随着节点数目的增多MEG和GS的系统总能耗减少，而OSPR系统总能耗增加。分析原因是:模型中节点越多，两个节点间的最短距离就越短。因此，对于MEG和GS算法，一个复制站点能够满足更多的站点的QoS，从而导致了CCDN系统总能耗的减少。OSPR没有考虑QoS，因此，随着云站点数目的增多，总能耗不断增大。4.3QoS实验实验把本文算法MEG与GS和OSPR，在QoS方面进行比较。QoS比较实验参数，除QoS值以外，使用默认的参数值，并且对于每个节点vi∈V，把qd(i)和qe(i)值设为相等。实验结果如图3所示。图3不同服务质量需求的系统总能耗比较图3可以观察到，给定服务质量(QoS)需求值，MEG的平均系统总能耗比GS少28.9%，表明MEG比GS更加节能。MEG的平均系统总能耗比OSPR少60.2%。分析原因是:由于MEG考虑了满足QoS的CCDN系统节能，QoS越大，节点的QoS值，越容易被满足，系统总能耗越小。OSPR没有考虑QoS，QoS对该方法没有优化能耗的效果。4.4网络拓扑密度实验评价网络拓扑密度对系统总能耗的影响。网络拓扑密度，由Waxman模型中设置的β值确定。网络拓扑密度实验参数，除β值以外，使用默认的参数值。在Waxman模型中，β值越大，网络拓扑密度越大。实验结果如图4所示。图4不同网络拓扑密度的系统总能耗比较从图4观察到，网络密度较高时(大于β≥0.6时)，MEG的系统总能耗最小。网络越密，MEG和GS的系统总能耗越低，OSPR系统总能耗越高。分析原因是:对于MEG和GS算法，网络拓扑越密，越少的站点数就能满足QoS需求，导致系统总能耗减少。OSPR没有考虑QoS，所以网络拓扑越密，云站点越多，系统总能耗越高。从图4可知，MEG的平均系统总能耗比GS少32.2%，比OSPR少89.3%，表明MEG比GS和OSPR更加节能。5结语本文针对云存储内容分发网络高能耗问题，提出了基于图算法的云存储内容分发网络能耗优化方法，主要工作有以下四个方面:首先，给出了CCDN数据分发中，节点间数据通信能耗和节点数据存储能耗公式；其次，提出了CCDN数据分发路径能耗优化选择问题；再次，给出了CCDN数据分发路径能耗优化的图算法；最后，将提出的能耗优化图算法与典型的CCDN能耗优化算法GS和OSPR进行了实验比较，验证了本文提出的能耗优化方法能够有效地节约能耗。下一步的工作是研究在用户随机到达的条件下，如何满足每个用户响应时间和服务成本QoS需求的CCDN能耗优化方法。
参考文献
[1]林闯，田源，姚敏.绿色网络和绿色评价:节能机制、模型和评价［J］.计算机学报，2011，34(4):593－612.

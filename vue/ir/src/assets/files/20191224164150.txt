计算机学报
绿色数据中心大数据填补及分类算法研究
袁景凌，钟珞，杨光，陈旻骋，顾骏程，李涛
摘要：随着云计算和大数据时代的到来，大规模数据中心在全球范围内得到了广泛的部署但大规模数据中心的高能耗仍然是当今亟待解决的问题为解决这一问题，通常采用太阳能等可再生绿色新能源为数据中心供电绿色数据中心能够根据新能源的变化配合市电为数据中心提供高效、低能耗且稳定的电能供给，这是数据中心发展的趋势文中针对数据收集不完善和断电等因素会造成一定程度的数据缺失情况，提出了一种基于完备相容类的不完备大数据填补算法，来填补数据中心的缺失数据；针对绿色数据中心能耗大数据的不稳定、间歇性和随时变化等特点，提出了一种基于离散弱相关的决策森林并行分类算法，通过对数据中心能耗大数据并行分类，来指导供电方式，以利于高效节能和延长电池寿命；此外进一步提出了一种增量更新决策森林的算法，来增量更新分类模型，该算法能够保障分类模型不断适应数据变化，防止分类准确率随时间而下降，从而避免电池频繁充放电，以保证稳定供电整体来说，文中提出了一种数据中心能耗大数据管理模型，该模型针对大规模绿色数据中心的能源供给相关问题，运用不完备能耗大数据的填补、能耗大数据的并行分类、分类模型更新这三方面的技术方法，动态调控太阳能和市电供电端口，为数据中心提供高效、低能耗且稳定的电能供给最后，采用绿色数据中心真实的能耗相关大数据集进行实验，实验结果说明文中提出的能耗大数据管理模型，能够帮助绿色数据中心有效管理太阳能和其他资源来配合市电提供稳定且充足的电能供应，从而为整个数据中心服务体系提供高效的能源服务
关键词：绿色数据中心；能耗大数据；不完备大数据填补；并行分类；增量更新；大数据
零、引言
随着云计算和大数据时代的到来，大规模数据中心在全球范围内得到了广泛的部署但其高能耗问题却越来越突出据不完全统计，2013年各类数据中心电能消耗量占全球年均总电能消耗量的05％按当前的发展趋势，预计到2020年，数据中心年均电能消耗量将占全球年均总电能消耗量的1％数据中心的高能耗造成了电能的浪费和系统的不稳定，同时也给环境带来了不利影响降低数据中心耗电量最直接的方法是提高数据中心效率，而合理使用新能源是数据中心提高效率、降低运维成本的主要途径ＩＢＭ曾提出“绿色数据中心的含义是提高数据中心的能源效率”因此，建立绿色数据中心是数据中心发展的趋势
绿色数据中心通常采用太阳能等绿色新能源为绿色数据中心供电虽然利用新能源能缓解数据中心对资源环境的压力，但目前数据中心依然不适合完全脱离传统电网如何协同配合传统电网和新能源的各自特点，并根据新能源的实时变化，控制市电供能端口和新能源供能端口以提供高效、低能耗的电能供给是如今所要面对的一个重要问题针对这个问题，我们需要高效处理绿色数据中心产生的能耗相关大数据（文中简称能耗大数据）能耗大数据规模庞大（Ｖｏｌｕｍｅ），且由于新能源不稳定，能耗大数据会随时变化（Ｖｅｌｏｃｉｔｙ）尽管能耗大数据很少涉及非结构化数据，但其需要考虑电流电压等信号、系统日志和新能源监控数据等诸多半结构化数据，以及断电等因素造成的数据不完备，使得数据形式更为复杂（Ｖａｒｉｅｔｙ）有效分析和处理能耗大数据
可减少电能消耗，这在当今计算规模庞大的云计算时代，具有极大的数据价值（Ｖａｌｕｅ）处理能耗大数据和控制数据中心电能供需要消耗电能并带来很高的操作开销，而且其伴随的电池的频繁充放电会给基础设施和环境造成负面影响如何运用数据挖掘相关算法，对数据中心的能耗大数据用途进行分类，从而指导供电方式是绿色数据中心需要重点考虑的问题然而，绿色数据中心因断电、设备故障、信息采集等因素造成的数据不完备问题，会严重降低分类效果，在数据属性密度低的情况下甚至影响分类模型的训练此外，随着数据中心中数据不断变化，根据历史数据建立的数据模型的适应性会不断下降
因此，对不完备能耗大数据的处理以及建立更合理的能耗管理模型，逐渐成为绿色数据中心所面临的新的挑战本文主要工作如下：
（1）针对太阳能等新能源供电不稳定、间歇性、设备故障、信息采集等因素造成的能耗数据缺失问题，提出了一种基于完备相容类的不完备大数据填补算法该算法扩展了粗糙集中的相容关系，保证数据的完备性，从而提高了分类的精度，并且并行实现了该算法以便高效处理大数据
（2）设计绿色数据中心的能耗管理架构，提出了一种适用能耗大数据的并行分类方法本文改进了传统的随机森林算法，提出一种基于离散弱相关的决策森林分类算法对能耗大数据并行分类；并且
进一步提出增量更新分类模型的算法，使得分类模型能够适应系统新产生的数据，防止分类准确率随时间推移而下降
二、相关工作
21　数据中心能耗模型
为了分析和处理数据中心的能耗大数据，首先需要构建能耗模型目前，关于数据中心能耗模型的构建，已有广泛的研究林闯等人将能量看作一种系统资源，从资源分配与任务管理角度分析了绿色网络的机制与策略，提出了基于随机模型的绿色评价框架，并对数据中心的能耗管理进行了理论建模和分析，提出了开销感知的作业调度算法Ｆａｎ等人改进了一元回归能耗模型，提出了不同的能耗管理框架Ｌｅｅ等人则利用服务器的最小功率、最大功率及ＣＰＵ的当前使用率来建立能耗模型Ｂｏｈｒａ等人提出了新的能耗分析工具Ｖｍｅｔｅｒ，对ＣＰＵ、ｃａｔｃｈｅ、内存与磁盘等系统组件分别进行监控，建立分解的四元线性模型Ｄｈｉｍａｎ等人根据ＣＰＵ利用率、ＩＰＣ、ＭＰＣ建立高斯混合模型，并采用概率建立了能耗与性能指标的关系Ｃｈｏｉ等人通过分析服务器整合、虚拟机迁移场景下的能源消耗，提出了一种动态环境下的能耗预测模型罗亮等人结合多元线性回归和非线性回归的数学方法，提出了一种适合云计算数据中心基础架构的服务器能耗模型王巍等人采用基于重载近似的大规模排队系统来对数据中心建模，设计了多数据中心间的负载路由机制，从而使数据中心能耗成本得到进一步优化孙大为等人系统地分析了实现绿色服务级目标的原理，提出了一种多维能耗模型Ｍ2ＥＣ，实现了云计算环境中能耗与服务级目标之间的均衡叶可江等人提出了一种针对虚拟化云计算平台的能耗建模方法李翔等人提出了面向多节点的热量管理机制的理论框架
此外，由于数据中心的运营离不开与电网之间的交互，具有新能源发电站的数据中心通常与智能电网合作，利用需求响应机制保障智能电网的稳定性我们合作的佛罗里达大学ＩＤＥＡＬ实验室设计了一种太阳能驱动的多核体系架构下的能耗管理方案ＳｏｌａｒＣｏｒｅ，该方案能凭据吞吐率和能耗的比值，利用ＤＶＦＳ技术动态调节每个核的负载，从而充分利用太阳能实现最优性能ＩＤＥＡＬ实验室的另一个研究成果ｉＳｗｉｔｃｈ能在两组服务器之间动态调节负载，使其能够最大化利用间歇、不稳定的新能源，并根据能源波动合理的迁移虚拟机在此
基础上，Ｌｉ等人提出了ＩｎＳＵＲＥ、ＰＤＳ、Ｏａｓｉｓ等多个能耗管理模型，为绿色数据中心运用能耗大数据提供高效稳定的能源供应服务提供了全新的思路
22　不完备数据填补
受新能源不稳定、间歇性、设备故障、信息采集误差等因素的影响，数据中心的能耗数据常常会出现不精确、不一致、不完整等问题对于上述问题，不完备数据的处理方法显得尤为重要，其一般分为直接处理方法和间接处理方法
直接处理方法既不删除含有缺失数据的记录，也不填补缺失数据，一般通过直接扩充粗糙集模型进行处理钱进和苗夺谦等人为适应不断扩大的数据规模，提出了基于粗糙集理论的面向大规模数据的并行知识约简算法，并通过实验证明其具有良好的可行性和较好的扩展性Ｙａｎｇ等人在基于优势关系的粗糙集模型的基础上，提出了基于相似优势关系的粗糙集决策方法，并将其应用于处理不
完备信息系统Ｙａｎｇ等人实现了粗糙集理论基于ＭａｐＲｅｄｕｃｅ的并行化Ｚｈａｎｇ等人比较了在
处理大数据的不同系统中，使用ＭａｐＲｅｄｕｃｅ实现的多种基于粗糙集的处理方法的优劣
间接处理方法一般指数据填补，其特点是采用某种方法（如基于概率统计）将不完备信息系统转化成完备信息系统武森通过分析不完备约束容差集合，提出了一种基于不完备数据聚类的缺失数据填补方法Ｇｅｂｒｅｇｚｉａｂｈｅｒ等人提出了一种用一系列可能值来填补缺失值，并进行综合分析得到总体参数的估计值的多重填补方法Ｄａｎｉｅｌ等人提出了一种通过估计值，结合不同的噪声，形成多组可选插补值的多重填补方法Ｈｏｎｇ等人利用上下近似提出了一种填补缺失值并同时提取规则的方法Ｚｈａｎｇ提出了一种利用基于灰色关联度的ｋＮＮ缺失数据填补算法我们也曾提出了一种针对不完备数据的自动阈值调节的动态量化非对称相似关系模型
23　大数据分类
对能耗大数据进行分类和分析，能够指导数据中心的供电方式，提高能源利用效率决策树是分类应用中采用最为广泛的模型之一相比神经网络及贝叶斯方法，决策树避免了消耗大量的时间和上千次的迭代来训练模型，且表现出了良好的分类效果，适用于不完备大数据集因此，众多学者将决策树改进，应用于不完备大数据的分类问题Ｆｒａｎｃｏ-Ａｒｃｅｇａ等人提出了一种能够有效解决内存限制问题的决策树构建方法，提高了决策树构建算法的计算速度王涛等人设计并实现了一种基于线索化排序二叉树的增量模糊决策树分类算法ｆＶＦＤＴ，该算法有效地降低了新样本插入及最佳划分节点选取的时间复杂度Ｙａｎｇ等人提出了一种用于处理带有噪音的大数据的增量优化的快速决策树算法ｉＯＶＦＤＴ，很好地处理了不完备大数据分类的问题而由多棵决策树组成的随机森林模型有着更为广泛的应用王爱平等人提出了一种增量式极端随机森林分类器，并将其应用于解决视频在线跟踪问题Ｈａｎ等人实现了基于ＭａｐＲｅｄｕｃｅ模型的可扩展随机森林算法ＳＭＲＦ，该算法更适用于大规模数据集在云计算平台上的分类Ｗａｎｇ等人将基于Ｈａｄｏｏｐ的随机森林分类算法应用于多元神经影像表型的全基因组关联分析
国内外研究机构已经对绿色数据中心的能耗模型进行了广泛的研究，也有较为成熟的数据处理方法但针对具体绿色数据中心的实际能耗大数据处理所面临的数据缺失和模型更新等问题还有待进一步研究因此，本文从数据中心能耗不完备大数据的填补、能耗大数据分类、分类模型增量更新3个方面分析和处理能耗大数据，构建更适合数据中心的能
耗大数据管理模型
3　能耗大数据管理模型
31　能耗大数据的定义
能耗大数据主要由两个方面组成，首先是环境监控数据，即监控数据中心的内部环境与辅助设备所得，包括对内部气流的温度、湿度等数据的测量和收集；其次是资源监控数据，即监控服务器集群、网络设施等云计算资源的物理参数与运行状况所得我们根据其获取方法将资源监控数据分成3种不同的类型第1种类型：直接从计算机或操作系统的接口获取，例如ＣＰＵ使用率、内存或网络带宽的使用状况等；第2种类型：对于部分数据，计算机与操作系统均未提供相应的接口进行测量，则需利用软硬件结合的方式或间接计算获得；第3种类型：通过集成在计算机主板、芯片上的传感器监控所得
为了准确地获取数据中心的运行状况，采集点越来越多，采样频率越来越高，普通的数据中心就达到百万甚至千万级且数据中心广域分布、数据类型繁多，包括实时数据、历史数据、文本数据、时间序列数据等各类结构化、半结构化数据海量的过程数据被保存下来，形成能耗大数据这些数据中蕴藏着丰富的信息，对绿色数据中心分析运行状态、提供控制和优化策略、故障诊断以及知识发现和数据挖掘具有重要意义。
32　能耗大数据的特点
能耗大数据不仅具备“4Ｖ”特征，即规模大（ｖｏｌｕｍｅ）、类型多（ｖａｒｉｅｔｙ）、价值密度低（ｖａｌｕｅ）和变化快（ｖｅｌｏｃｉｔｙ），而且这些特征又和其他大数据有所区别能耗大数据规模大且阶段性变化：这些数据是由不同检测点按一定间隔阶段性收集的，常规ＳＣＡＤＡ系统包含上万个检测点，按采样间隔3ｓ到4ｓ计算，每年约产生1ＴＢ数据
能耗大数据范畴大且类型繁多：数据中心中与能源有关的数据都属于能耗大数据，它的数据种类众多，各类数据的处理频度及性能要求也不尽相同能耗大数据价值密度低且变化快：在几十毫秒内会更新大量数据，历史数据会不断积累，单一数据中心的某一时间点的数据对于数据分析没有任何意义，数据价值密度低，因此，需要同时综合考虑历史数据以及更新数据另外，软硬件、断电和能源不稳定等因素可能引起服务器、交换机、机架等故障，从而会导致能耗大数据出现一定程度的不完备同时，ＲＴＵ采集、电能表采集、通道状况、参数设置等多种因素也会影响数据中心能耗大数据的质量这些缺失数据不仅会对数据中心的能耗有影响，还可能危及到整个数据中心的正常运转所以，及时地处理能耗大数据，对数据中心的安全问题和数据中心减少能耗均有很大的益处
33　能耗大数据管理模型
针对绿色数据中心规模大、数据处理时效性强、数据监控来自多个不同渠道等特征，本文抽象出了如图1所示的绿色数据中心的能耗大数据管理架构，一般通过特定的监控设备完成对环境的监控，并在每个服务器上运行监控程序（例如可以是一个守护进程）进行资源监控这些设备和进程通过一定的标准规范与主节点进行通信，传输收集的数据整个能耗大数据管理模型首先由主节点对原始数据加上时间戳，并对其进行预处理，然后对能耗不完备大数据进行填补处理，随后根据处理后的数据建立决策森林，并按时间戳不断使用新增数据集增量更新之前的决策森林模型，最后根据决策森林分类的结果（太阳能和市电端口开关数）制定电能供应策略，有效管理太阳能和其他资源配合市电提供电能供应，从而为整个数据中心服务体系提供高效的能源服务
4　不完备大数据填补方法
数据中心的能耗大数据不仅规模大，而且往往要面临数据采集不完善、断电、故障等因素造成信息大量缺失的难题传统粗糙集理论一般只能处理完备的信息系统，为了使粗糙集理论能适应于能耗大数据的处理，通常采用模型扩充或数据填补方法但模型扩展方法不能在保持数据标签唯一的情形下处理不完备数据，且空值过多时会失效基于粗糙集的填补方法可以处理数据属性缺失量大的情况，但是该方法中求解相容关系以及相容类十分复杂，不适合数据规模大且阶段性变化的能耗大数据因此，本文将相容关系扩展为完备相容关系，用于划分完备相容类，并在此基础上提出不完备大数据填补算法来填补数据中心能耗大数据中的缺失属性值
首先，需要将数据集中的连续属性离散化然后，将属性值缺失的不完备数据与完备数据区分开来（为保证分类准确性，去除决策属性缺失的记录），并分别生成属性值序列和倒排索引接着，检测不完备数据是否存在完备相容类若有完备相容类，根据最小描述长度原则（ＭＤＬ），选择条件属性对决策属性预测的不确定性最小的属性值来填补缺失属性值反之，选择缺失属性中频率最
大的属性值来填补该缺失属性值不完备大数据填补算法流程如图2所示
根据倒排索引，该算法并行地将数据记录划分为完备相容类，并分别在各完备相容类中并行计算填补的候选值，充分发挥了云平台的数据并行化优势
其中，系统从云平台的ＨＤＦＳ中读取数据，数据输出到ＨＤＦＳ都是并行执行的过程，避免因读写数据造成的任务等待，充分发挥数据并行优势Ｊｏｂ1的任务是分离不完备数据对于执行Ｊｏｂ1的节点，多个ＭａｐＲｅｄｕｃｅ任务分别检测数据集分片中属性缺失的情况经Ｊｏｂ1分离出的决策属性缺失的不完备数据，条件缺失的不完备数据以及完备数据分别提交给Ｊｏｂ2、Ｊｏｂ3和Ｊｏｂ4处理Ｊｏｂ2负责统计决策属性缺失数据的记录ＩＤ，Ｊｏｂ3为条件属性缺失数据建立倒排索引，Ｊｏｂ4负责生成完备数据的属性值序列，3个任务在不同节点上并行执行Ｊｏｂ3和Ｊｏｂ4将执行结果提交给Ｊｏｂ5Ｊｏｂ5负责并行求解完备相容类，将存在完备相容类的部分提交给Ｊｏｂ７，将不存在完备相容类的部分提交给Ｊｏｂ8Ｊｏｂ７负责根据完备相容类填补缺失属性值，Ｊｏｂ8负责根据属性值的频率填补缺失属性值，而Ｊｏｂ6负责去除决策属性缺失的数据，Ｊｏｂ6、Ｊｏｂ７和Ｊｏｂ8这3个任务可以并行执行
5　能耗大数据并行分类
数据中心主要通过控制太阳能供电端口和市电供电端口，调整供电方式和能源使用方式对能耗大
数据的合理分类，可以根据分类结果指导供电方式，
更为高效的使用太阳能等新能源，配置市电电能供
给，从而避免数据中心中电能存储设备的频繁充放
电，在延长设备寿命的同时保护环境因此，本文设
计了数据中心能耗大数据并行分类方法
51　能耗大数据的分类算法改进策略
能耗大数据信息量大、数据的维度高、数据的结构复杂，传统的分类算法在对其进行处理时会显得力不从心随机森林分类算法训练过程复杂度低，预测算法的速度很快，对噪音有较好的耐受能力，且对高维数据分类问题具有良好的可扩展性和并行性因此随机森林分类算法十分适用于处理能耗大数据
（1）随机森林分类建立随机森林的过程实质是构建多棵决策树的过程在建立决策树时，建树过程中会随机抽取若干个属性，计算最大增益属性作为结点当使用随机森林分类时，每棵决策树都参与分类，并通过投票机制决定输入数据的分类类别（2）改进策略1：选择合适的决策树及属性个数使用随机森林对大数据进行分类时，决策树的个数会在一定程度上影响建立模型的时间效率（建模时间）、空间效率（结点数）和分类效果（准确率）因此，在对数据中心的能耗大数据分类之前，应该综合考虑属性个数，平台节点数以及数据规模，计算出较为合适的输入参数（3）改进策略2：离散化连续属性数据中心的能耗大数据往往具有多维连续属性，对连续属性进行离散化能够在一定程度上提高分类的准确率和可靠性（4）改进策略3：弱相关化随机抽样属性组在能耗大数据的分类过程中，由于太阳能的不稳定性，会导致属性值的关联具有一定的随机性合适的属性选择方法，能提高能耗大数据的分类准确率和可靠性因此，本文采用了相关性检测的方法在保证随机抽样的前提下，选择与已抽样属性组相关性最小的属性元组，作为参与建树属性，从而降低决策树之间的相关性，提高决策树对领域的覆盖精度，保证随机森林模型更加合理
6　增量更新决策森林算法
增量更新分类模型是能耗大数据管理模型的一个重要步骤数据中心中用于处理能耗大数据的虚拟机会动态迁移，以保证各数据中心充分利用资源随着时间的推移，虚拟机的迁移以及环境因素的变化会导致分类模型的分类效果越来越差；且能耗大数据的规模庞大，读取全部数据，重建分类模型会造成大量的时间和空间的开销；而且数据中心更新速度快，能耗大数据变化大，历史数据不断积累数据的价值会随着时间的流逝而不断下降，因此需要尽快地对最新的数据做出分析并对模型做出调整
61　增量更新能耗大数据分类模型
本文提出增量更新决策森林算法（ＩｎｃｒｅｍｅｎｔａｌＵｐｄａｔｉｎｇ　Ｄｅｃｉｓｉｏｎ　Ｆｏｒｅｓｔ算法，简称ＩＵＤＦ算法），来解决分类模型无法处理数据规模大，并不断更新。
62　增量更新决策森林算法的并行化
数据中心通常采用太阳能等不稳定的新能源辅助供电，因此对能耗大数据的分析和处理策略需要不断调整由于决策森林模型由多棵决策树组成，不同决策树的使用互不影响，因此增量更新模型和决策森林分类都可以并行处理多棵决策树的问题
8　结论语
绿色数据中心，在提供高效、稳定的电能供给的同时，也能够降低能耗、保护环境和节省成本，这是未来数据中心发展的必然趋势本文根据绿色数据中心能耗大数据的特点，针对大规模绿色数据中心的能源供给相关问题，提出了一种数据中心能耗大数据管理模型：提出基于完备相容类的不完备大数据填补算法，保证了数据的完备性，降低了数据缺失对分类的影响；提出了基于离散弱相关的决策森林分类算法，对数据中心能耗大数据并行分类，用于动态调控太阳能和市电供电端口；进一步提出了增量更新决策森林模型算法，使得分类模型能根据实际数据的变化不断更新模型本文研究通过分析和处理能耗大数据，有效管理太阳能和其他资源来配合市电提供稳定且充足的电能供应，为数据中心服务体系提供了高效的能源服务今后，将进一步全面研究绿色数据中心的能耗评估体系和能源服务策略
参考文献
[1]孙大为，常桂然，陈东，王兴伟云计算环境中绿色服务级目标的分析、量化、建模及评价计算机学报，2013，36（７）：150９-1525
[2]邓维，刘方明，金海，李丹云计算数据中心的新能源应用：研究现状与趋势计算机学报，2013，36（3）：582-5９8
[3]罗亮，吴文峻，张飞面向云计算数据中心的能耗建模方法软件学报，2014，25（７）：13７1-138７
[4]钱进，苗夺谦，张泽华，张志飞ＭａｐＲｅｄｕｃｅ框架下并行知识约简算法模型研究计算机科学与探索，2013，７（1）：35-45